<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Police Hub</title>

<style>
:root{
  --bg:#0b1220;
  --sidebar:#0f172a;
  --header:#020617;
  --card:#111827;
  --border:#1e293b;
  --accent:#2563eb;
  --text:#e5e7eb;
  --muted:#9ca3af;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  height:60px;
  background:var(--header);
  display:flex;
  align-items:center;
  padding:0 20px;
  font-size:20px;
  font-weight:600;
  border-bottom:1px solid var(--border);
}
.wrapper{
  display:flex;
  height:calc(100vh - 60px);
}
aside{
  width:240px;
  background:var(--sidebar);
  padding:15px;
  border-right:1px solid var(--border);
}
aside h3{
  font-size:13px;
  color:var(--muted);
  margin-bottom:10px;
}
aside button{
  width:100%;
  background:none;
  border:none;
  color:var(--text);
  padding:10px 12px;
  text-align:left;
  border-radius:6px;
  cursor:pointer;
}
aside button:hover{background:#1e293b}
main{
  flex:1;
  padding:25px;
  overflow-y:auto;
}
.hidden{display:none}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:20px;
  margin-bottom:20px;
}
input,textarea{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  background:#020617;
  border:1px solid var(--border);
  color:var(--text);
  border-radius:6px;
}
button.action{
  background:var(--accent);
  border:none;
  padding:10px 14px;
  color:white;
  border-radius:6px;
  cursor:pointer;
}
.officer{
  background:#020617;
  border:1px solid var(--border);
  border-radius:6px;
  padding:8px;
  margin-bottom:6px;
  cursor:grab;
}
.patrol{
  border:1px dashed var(--border);
  border-radius:8px;
  padding:12px;
  margin-bottom:15px;
}
.patrol h4{
  margin:0 0 8px 0;
}
</style>
</head>

<body>

<header>ðŸš“ Police Hub</header>

<div class="wrapper">
  <aside>
    <h3>Navigation</h3>
    <button onclick="showPage('dashboard')">Dashboard</button>
    <button onclick="showPage('crimes')">Straftaten</button>
    <button onclick="showPage('patrols')">Streifensystem</button>
  </aside>

  <main>

    <!-- DASHBOARD -->
    <div id="dashboard" class="card">
      <h2>Dashboard</h2>
      <p>Interne Ãœbersicht des Police Hubs.</p>
    </div>

    <!-- STRAFTATEN (unverÃ¤ndert) -->
    <div id="crimes" class="card hidden">
      <h2>Straftaten</h2>
      <input id="crimeName" placeholder="Tatbestand">
      <textarea id="crimePenalty" placeholder="Strafe / Beschreibung"></textarea>
      <button class="action" onclick="addCrime()">Straftat hinzufÃ¼gen</button>
      <table id="crimeTable"></table>
    </div>

    <!-- STREIFENSYSTEM -->
    <div id="patrols" class="card hidden">
      <h2>Streifensystem</h2>

      <div style="display:grid;grid-template-columns:2fr 1fr;gap:20px;">

        <!-- STREIFEN -->
        <div id="patrolList"></div>

        <!-- OFFICER -->
        <div>
          <h3>Officer</h3>

          <input id="searchOfficer" placeholder="Officer suchen (Name / DN)" oninput="renderOfficers()">

          <input id="oFirst" placeholder="Vorname">
          <input id="oLast" placeholder="Nachname">
          <input id="oNr" placeholder="Dienstnummer">
          <button class="action" onclick="addOfficer()">Officer hinzufÃ¼gen</button>

          <div id="officerList" style="margin-top:10px;"></div>
        </div>

      </div>
    </div>

  </main>
</div>

<script>
function showPage(id){
  document.querySelectorAll("main > div").forEach(d=>d.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

/* STRAFTATEN */
function addCrime(){
  if(!crimeName.value) return;
  const c=JSON.parse(localStorage.getItem("crimes")||"[]");
  c.push({n:crimeName.value,p:crimePenalty.value});
  localStorage.setItem("crimes",JSON.stringify(c));
  crimeName.value=crimePenalty.value="";
  loadCrimes();
}
function loadCrimes(){
  crimeTable.innerHTML="<tr><th>Tatbestand</th><th>Strafe</th></tr>";
  JSON.parse(localStorage.getItem("crimes")||"[]")
    .forEach(c=>crimeTable.innerHTML+=`<tr><td>${c.n}</td><td>${c.p}</td></tr>`);
}

/* STREIFENSYSTEM */
const patrolIds=["1120","1121","1122","1123","1124","1125"];
let officers=JSON.parse(localStorage.getItem("officers")||"[]");
let patrols=JSON.parse(localStorage.getItem("patrols")||"{}");

patrolIds.forEach(id=>{
  if(!patrols[id]) patrols[id]=[];
});
localStorage.setItem("patrols",JSON.stringify(patrols));

function addOfficer(){
  if(!oFirst.value||!oLast.value||!oNr.value) return;
  officers.push({id:Date.now(),f:oFirst.value,l:oLast.value,n:oNr.value});
  localStorage.setItem("officers",JSON.stringify(officers));
  oFirst.value=oLast.value=oNr.value="";
  renderOfficers();
}

function renderOfficers(){
  const q=searchOfficer.value.toLowerCase();
  officerList.innerHTML="";
  officers
    .filter(o=>`${o.f} ${o.l} ${o.n}`.toLowerCase().includes(q))
    .forEach(o=>{
      const d=document.createElement("div");
      d.className="officer";
      d.draggable=true;
      d.dataset.id=o.id;
      d.ondragstart=e=>e.dataTransfer.setData("officer",o.id);
      d.innerHTML=`${o.f} ${o.l}<br><small>DN: ${o.n}</small>`;
      officerList.appendChild(d);
    });
}

function renderPatrols(){
  patrolList.innerHTML="";
  patrolIds.forEach(id=>{
    const div=document.createElement("div");
    div.className="patrol";
    div.ondragover=e=>e.preventDefault();
    div.ondrop=e=>{
      const oid=e.dataTransfer.getData("officer");
      Object.values(patrols).forEach(p=>p.splice(p.indexOf(oid),1));
      patrols[id].push(oid);
      localStorage.setItem("patrols",JSON.stringify(patrols));
      renderPatrols();
    };

    let members=patrols[id].map(oid=>{
      const o=officers.find(x=>x.id==oid);
      return o?`${o.f} ${o.l} (${o.n})`:"";
    }).join("<br>");

    div.innerHTML=`
      <h4>Streife ${id}${id==="1120"?" â€“ FÃ¼hrung":""}</h4>
      ${members||"<em>Keine Officer</em>"}
    `;
    patrolList.appendChild(div);
  });
}

loadCrimes();
renderOfficers();
renderPatrols();
</script>

</body>
</html>
